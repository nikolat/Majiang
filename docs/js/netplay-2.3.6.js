(()=>{"use strict";var e={6321:e=>{e.exports=JSON.parse('{"Mリーグルール":{"配給原点":25000,"順位点":["+30.0","+10.0","-10.0","-30.0"],"赤牌":{"m":1,"p":1,"s":1},"連風牌は2符":true,"クイタンあり":true,"喰い替え許可レベル":0,"場数":2,"途中流局あり":false,"流し満貫あり":false,"ノーテン宣言あり":true,"ノーテン罰あり":true,"最大同時和了数":1,"連荘方式":2,"トビ終了あり":false,"オーラス止めあり":false,"延長戦方式":0,"一発あり":true,"裏ドラあり":true,"カンドラあり":true,"カン裏あり":true,"カンドラ後乗せ":false,"ツモ番なしリーチあり":true,"リーチ後暗槓許可レベル":1,"ダブル役満あり":false,"役満の複合あり":true,"数え役満あり":false,"役満パオあり":true,"切り上げ満貫あり":true},"Classicルール":{"配給原点":30000,"順位点":["+12.0","+4.0","-4.0","-12.0"],"赤牌":{"m":0,"p":0,"s":0},"連風牌は2符":false,"クイタンあり":true,"喰い替え許可レベル":2,"場数":2,"途中流局あり":false,"流し満貫あり":false,"ノーテン宣言あり":false,"ノーテン罰あり":false,"最大同時和了数":1,"連荘方式":1,"トビ終了あり":false,"オーラス止めあり":false,"延長戦方式":0,"一発あり":false,"裏ドラあり":false,"カンドラあり":false,"カン裏あり":false,"カンドラ後乗せ":false,"ツモ番なしリーチあり":true,"リーチ後暗槓許可レベル":0,"ダブル役満あり":false,"役満の複合あり":false,"数え役満あり":false,"役満パオあり":false,"切り上げ満貫あり":false}}')}},a={};function t(o){var r=a[o];if(void 0!==r)return r.exports;var l=a[o]={exports:{}};return e[o](l,l.exports,t),l.exports}(()=>{
/*!
 *  電脳麻将: ネット対戦 v2.3.6
 *
 *  Copyright(C) 2017 Satoshi Kobayashi
 *  Released under the MIT license
 *  https://github.com/kobalab/Majiang/blob/master/LICENSE
 */
const{hide:e,show:a,fadeIn:o,scale:r,setSelector:l,clearSelector:n}=Majiang.UI.Util,i=t(6321),s=location.pathname.replace(/\/[^\/]*?$/,"");let m;$((function(){const t=Majiang.UI.pai($("#loaddata")),l=Majiang.UI.audio($("#loaddata")),n=e=>($("body").addClass("analyzer"),new Majiang.UI.Analyzer($("#board > .analyzer"),e,t,(()=>$("body").removeClass("analyzer")))),u=new Majiang.UI.PaipuFile($("#file"),"Majiang.netplay",(e=>($("#board .controller").addClass("paipu"),$("body").attr("class","board"),r($("#board"),$("#space")),new Majiang.UI.Paipu($("#board"),e,t,l,"Majiang.pref",(()=>o($("body").attr("class","file"))),n))),(e=>(o($("body").attr("class","stat")),new Majiang.UI.PaipuStat($("#stat"),e,(()=>o($("body").attr("class","file")))))));let f,d,c,p;function g(){f=io("/",{path:`${s}/server/socket.io/`}),f.on("HELLO",y),f.on("ROOM",b),f.on("START",M),f.on("END",v),f.on("ERROR",u.error),f.on("disconnect",(()=>e($("#file .netplay form.room")))),e($("#title .loading"))}function y(e){if(!e)return $("body").attr("class","title"),void a($("#title .login"));d=e.uid,a($("#file .netplay form")),o($("body").attr("class","file")),e.icon&&$("#file .netplay img").attr("src",e.icon).attr("title",e.uid),$("#file .netplay .name").text(e.name),u.redraw()}function b(t){c||(c=$("#room .user").eq(0),p=$("img",c).attr("src")),$("body").attr("class","room"),$('#room input[name="room_no"]').val(t.room_no),$("#room .room").empty();for(let e of t.user){let o=c.clone();e.icon?$("img",o).attr("src",e.icon).attr("title",e.uid):$("img",o).attr("src",p),$(".name",o).text(e.name),t.user[0].uid!=d&&e.uid!=d||a($('input[name="quit"]',o).on("click",(()=>(f.emit("ROOM",t.room_no,e.uid),!1)))),e.offline?o.addClass("offline"):o.removeClass("offline"),$("#room .room").append(o)}t.user[0].uid==d?(a($('#room select[name="rule"]')),a($('#room input[name="timer"]')),a($('#room input[type="submit"]'))):(e($('#room select[name="rule"]')),e($('#room input[name="timer"]')),e($('#room input[type="submit"]')))}function M(){const e=new Majiang.UI.Player($("#board"),t,l);e.view=new Majiang.UI.Board($("#board .board"),t,l,e.model);new Majiang.UI.GameCtl($("#board"),"Majiang.pref",null,e,e._view)._view.no_player_name=!1;let a=[];$("#board .controller").removeClass("paipu"),$("body").attr("class","board"),r($("#board"),$("#space")),f.off("ROOM"),f.on("GAME",(t=>{if(t.players)a=t.players;else if(t.say)e._view.say(t.say.name,t.say.l);else if(t.seq)e.action(t,((e={})=>{e.seq=t.seq,f.emit("GAME",e)}));else if(e.action(t),t.kaiju&&t.kaiju.log){let a=t.kaiju.log.pop();for(let t of a)e.action(t)}e._view.players(a)}))}function v(e){f.removeAllListeners("GAME"),f.on("ROOM",b),e&&u.add(e,10),o($("body").attr("class","file")),u.redraw(),$('#file input[name="room_no"]').val("")}for(let e of Object.keys(i))$('select[name="rule"]').append($("<option>").val(e).text(e));localStorage.getItem("Majiang.rule")&&$('select[name="rule"]').append($("<option>").val("-").text("カスタムルール")),$("#file form.room").on("submit",(e=>{let a=$('input[name="room_no"]',$(e.target)).val();return f.emit("ROOM",a),!1})),$("#room form").on("submit",(e=>{let a=$('input[name="room_no"]',$(e.target)).val(),t=$('select[name="rule"]',$(e.target)).val();t=t?"-"==t?JSON.parse(localStorage.getItem("Majiang.rule")||"{}"):i[t]:{},t=Majiang.rule(t);let o=$('input[name="timer"]',$(e.target)).val();return o=o.match(/(\d+)/g),o&&(o=o.map((e=>+e))),f.emit("START",a,t,o),!1})),$(window).on("resize",(()=>r($("#board"),$("#space")))),$(window).on("load",(()=>setTimeout(g,500))),m&&$(window).trigger("load"),$("#title .login form").each((function(){let a=$(this).attr("method"),t=$(this).attr("action");fetch(t,{method:a,redirect:"manual"}).then((a=>{404==a.status&&e($(this))}))}))})),$(window).on("load",(()=>m=!0))})()})();